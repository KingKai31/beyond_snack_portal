{% extends "base.html" %}
{% block content %}

<style>
  .card-box {
    max-width: 520px;
    margin: auto;
    background: #ffffff;
    padding: 22px;
    border-radius: 14px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.08);
  }

  .btn-group {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  .btn-group .button {
    flex: 1;
  }

  .button.is-selected {
    background-color: #3273dc;
    color: #ffffff;
  }
</style>

<div class="card-box">
  <h1 class="title is-4 has-text-centered">Breakage Analysis</h1>

  <form method="POST" enctype="multipart/form-data" id="breakForm">

    <!-- LINE -->
    <div class="field">
      <label class="label">Line *</label>
      <div class="btn-group">
        <button type="button" class="button is-light"
          onclick="setValue('line','Line 1',this)">Line 1</button>
        <button type="button" class="button is-light"
          onclick="setValue('line','Line 2',this)">Line 2</button>
      </div>
      <input type="hidden" name="line" id="line" required>
    </div>

    <!-- PRODUCT CODE -->
    <div class="field">
      <label class="label">Product Code *</label>
      <div class="select is-fullwidth">
        <select name="product_code" id="product_code" required onchange="checkForm()">
          <option value="">Select product code</option>
          <option>OS10G</option><option>PP10G</option><option>CO10G</option><option>SP10G</option>
          <option>DM10G</option><option>HS10G</option>
          <option>OS25G</option><option>PP25G</option><option>CO25G</option><option>SP25G</option>
          <option>OS26G</option><option>PP26G</option><option>CO26G</option><option>SP26G</option>
          <option>DM26G</option><option>HS26G</option>
          <option>OS48G</option><option>PP48G</option><option>CO48G</option><option>SP48G</option>
          <option>DM48G</option><option>HS48G</option>
          <option>OS75G</option><option>PP75G</option><option>CO75G</option><option>SP75G</option>
          <option>DM75G</option><option>HS75G</option>
          <option>OS100G</option><option>PP100G</option><option>CO100G</option><option>SP100G</option>
          <option>DM100G</option><option>HS100G</option>
          <option>OS150G</option><option>PP150G</option><option>CO150G</option><option>SP150G</option>
          <option>DM150G</option><option>HS150G</option>
          <option>CPOSPPCO300G</option>
          <option>CPOSPPCO600G</option>
        </select>
      </div>
    </div>

    <!-- GOOD % -->
    <div class="field">
      <label class="label">Good Chips % *</label>
      <input class="input" type="number" step="0.01" inputmode="decimal"
        name="good" id="good" required oninput="checkForm()">
    </div>

    <!-- BROKEN % -->
    <div class="field">
      <label class="label">Broken Chips % *</label>
      <input class="input" type="number" step="0.01" inputmode="decimal"
        name="broken" id="broken" required oninput="checkForm()">
    </div>

    <!-- CLUSTER % -->
    <div class="field">
      <label class="label">Cluster % *</label>
      <input class="input" type="number" step="0.01" inputmode="decimal"
        name="cluster" id="cluster" required oninput="checkForm()">
    </div>

    <!-- RESIDUE % -->
    <div class="field">
      <label class="label">Residue % *</label>
      <input class="input" type="number" step="0.01" inputmode="decimal"
        name="residue" id="residue" required oninput="checkForm()">
    </div>

    <!-- PHOTO -->
    <div class="field">
      <label class="label">Photo (optional)</label>
      <input class="input" type="file" name="photo" accept="image/*">
    </div>

    <!-- REMARKS -->
    <div class="field">
      <label class="label">Remarks (optional)</label>
      <textarea class="textarea" name="remarks"></textarea>
    </div>

    <!-- SUBMIT -->
    <button class="button is-primary is-fullwidth mt-4"
      id="submitBtn" disabled>
      Submit Breakage Analysis
    </button>

  </form>
</div>

<script>
function setValue(field, value, btn){
  document.getElementById(field).value = value;
  btn.parentElement.querySelectorAll('.button').forEach(b=>{
    b.classList.remove('is-selected');
  });
  btn.classList.add('is-selected');
  checkForm();
}

function checkForm(){
  const required = [
    'line','product_code',
    'good','broken','cluster','residue'
  ];
  const ok = required.every(id => document.getElementById(id).value);
  document.getElementById('submitBtn').disabled = !ok;
}
</script>

{% endblock %}
