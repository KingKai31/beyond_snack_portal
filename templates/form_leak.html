{% extends "base.html" %}
{% block content %}

<style>
  .card-box {
    max-width: 520px;
    margin: auto;
    background: #ffffff;
    padding: 22px;
    border-radius: 14px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.08);
  }

  .btn-group {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  .btn-group .button {
    flex: 1;
  }

  .button.is-selected {
    background-color: #3273dc;
    color: #ffffff;
  }
</style>

<div class="card-box">
  <h1 class="title is-4 has-text-centered">Leak Test</h1>

  <form method="POST" id="leakForm">

    <!-- LINE -->
    <div class="field">
      <label class="label">Line *</label>
      <div class="btn-group">
        <button type="button" class="button is-light"
                onclick="setValue('line','Line 1',this)">Line 1</button>
        <button type="button" class="button is-light"
                onclick="setValue('line','Line 2',this)">Line 2</button>
      </div>
      <input type="hidden" name="line" id="line" required>
    </div>

    <!-- FLAVOUR -->
    <div class="field">
      <label class="label">Flavour *</label>
      <div class="select is-fullwidth">
        <select name="flavour" id="flavour" required onchange="checkForm()">
          <option value="">Select flavour</option>
          <option>OS</option><option>PP</option><option>CO</option><option>SP</option>
          <option>DM</option><option>HS</option><option>SC</option><option>MB</option>
          <option>DP</option><option>RS</option><option>TO</option><option>SN</option>
          <option>PU</option><option>AC</option><option>MA</option>
          <option>Combo Pack</option>
        </select>
      </div>
    </div>

    <!-- GRAMMAGE -->
    <div class="field">
      <label class="label">Grammage (g) *</label>
      <div class="select is-fullwidth">
        <select name="grammage" id="grammage" required onchange="checkForm()">
          <option value="">Select grammage</option>
          <option>10</option>
          <option>15</option>
          <option>25</option>
          <option>26</option>
          <option>48</option>
          <option>50</option>
          <option>75</option>
          <option>85</option>
          <option>89</option>
          <option>100</option>
          <option>120</option>
          <option>125</option>
          <option>150</option>
          <option>235</option>
          <option>250</option>
          <option>300</option>
          <option>320</option>
          <option>400</option>
          <option>450</option>
          <option>600</option>
        </select>
      </div>
    </div>

    <!-- PRESSURE -->
    <div class="field">
      <label class="label">Pressure (mm Hg) *</label>
      <div class="select is-fullwidth">
        <select name="pressure" id="pressure" required onchange="checkForm()">
          <option value="">Select pressure</option>
          <option>150</option>
          <option>200</option>
          <option>250</option>
          <option>300</option>
          <option>350</option>
          <option>400</option>
          <option>450</option>
        </select>
      </div>
    </div>

    <!-- RESULT -->
    <div class="field">
      <label class="label">Result *</label>
      <div class="btn-group">
        <button type="button" class="button is-light"
                onclick="setValue('result','Pass',this)">Pass</button>
        <button type="button" class="button is-light"
                onclick="setValue('result','Fail',this)">Fail</button>
      </div>
      <input type="hidden" name="result" id="result" required>
    </div>

    <!-- REMARKS -->
    <div class="field">
      <label class="label">Remarks (optional)</label>
      <textarea class="textarea" name="remarks"
                placeholder="Optional remarks"></textarea>
    </div>

    <!-- SUBMIT -->
    <button class="button is-primary is-fullwidth mt-4"
            id="submitBtn" disabled>
      Submit Leak Test
    </button>

  </form>
</div>

<script>
function setValue(field, value, btn) {
  document.getElementById(field).value = value;

  btn.parentElement.querySelectorAll('.button').forEach(b => {
    b.classList.remove('is-selected');
  });
  btn.classList.add('is-selected');

  checkForm();
}

function checkForm() {
  const required = ['line', 'flavour', 'grammage', 'pressure', 'result'];
  const ok = required.every(id => document.getElementById(id).value);
  document.getElementById('submitBtn').disabled = !ok;
}
</script>

{% endblock %}
